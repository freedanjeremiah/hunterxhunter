{% extends "base.html" %}

{% block title %}Walrus Repository Dashboard{% endblock %}

{% block content %}
<div class="dashboard-header">
    <h1><i class="fas fa-cube"></i> Your Walrus Repositories</h1>
    <p class="subtitle">GitHub-like interface for your decentralized repositories</p>
</div>

<div class="dashboard-stats">
    <div class="stat-card">
        <div class="stat-number">{{ repositories|length }}</div>
        <div class="stat-label">Repositories</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{ repositories|selectattr('blob_id')|list|length }}</div>
        <div class="stat-label">Stored Blobs</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">Testnet</div>
        <div class="stat-label">Network</div>
    </div>
</div>

{% if repositories %}
<div class="repositories-container">
    <div class="section-header">
        <h2><i class="fas fa-folder"></i> Repositories</h2>
        <div class="upload-hint">
            <i class="fas fa-info-circle"></i>
            Use <code>walrus-push .</code> to upload new repositories
        </div>
    </div>
    
    <div class="repositories-grid">
        {% for repo in repositories %}
        <div class="repo-card">
            <div class="repo-header">
                <div class="repo-info">
                    <h3 class="repo-name">
                        <a href="/repo/{{ repo.blob_id }}">
                            <i class="fas fa-book"></i>
                            {{ repo.name }}
                        </a>
                    </h3>
                    <p class="repo-path">{{ repo.path }}</p>
                </div>
                <div class="repo-status">
                    <span class="status-badge stored">
                        <i class="fas fa-cloud-upload-alt"></i>
                        Stored
                    </span>
                </div>
            </div>
            
            <div class="repo-meta">
                <div class="meta-item">
                    <i class="fas fa-fingerprint"></i>
                    <span class="blob-id">{{ repo.blob_id[:16] }}...</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-clock"></i>
                    <span class="timestamp">{{ repo.last_updated[:10] }}</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-hashtag"></i>
                    <span class="hash">{{ repo.hash[:8] }}</span>
                </div>
            </div>
            
            <div class="repo-actions">
                <a href="/repo/{{ repo.blob_id }}" class="btn btn-primary">
                    <i class="fas fa-eye"></i>
                    View Repository
                </a>
                <button class="btn btn-secondary" onclick="copyToClipboard('{{ repo.blob_id }}')">
                    <i class="fas fa-copy"></i>
                    Copy Blob ID
                </button>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% else %}
<div class="empty-state">
    <div class="empty-icon">
        <i class="fas fa-cube"></i>
    </div>
    <h2>No repositories yet</h2>
    <p>Start by uploading your first repository to Walrus:</p>
    <div class="empty-actions">
        <div class="code-example">
            <code>cd your-project</code><br>
            <code>walrus-push .</code>
        </div>
        <p>Then refresh this page to see your uploaded repository!</p>
    </div>
</div>
{% endif %}

<div class="help-section">
    <h3><i class="fas fa-question-circle"></i> How it works</h3>
    <div class="help-grid">
        <div class="help-item">
            <div class="help-icon"><i class="fas fa-upload"></i></div>
            <div class="help-content">
                <h4>1. Upload</h4>
                <p>Use <code>walrus-push .</code> to upload your project directory to Walrus storage</p>
            </div>
        </div>
        <div class="help-item">
            <div class="help-icon"><i class="fas fa-cloud"></i></div>
            <div class="help-content">
                <h4>2. Store</h4>
                <p>Your project gets compressed and stored as a blob on the Walrus decentralized network</p>
            </div>
        </div>
        <div class="help-item">
            <div class="help-icon"><i class="fas fa-eye"></i></div>
            <div class="help-content">
                <h4>3. View</h4>
                <p>Browse your code through this GitHub-like interface with syntax highlighting</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}